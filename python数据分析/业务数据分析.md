### 业务数据分析流程

1. 业务理解
   1. 数据分析的起点（最重要的环节）
2. 数据收集
   1. 多渠道获取数据
3. 数据处理
   1. 数据清洗
   2. 数据整理
4. 数据分析
   1. 搭建多维数据分析环境
   2. 描述性分析
5. 数据展现
   1. 数据可视化展示
6. 成果报告
   1. 数据分析报告
   2. 商业智能(BI)分析报表

### BI商业智能

可视化和交互式的结合

#### 可视化——连接数据与人类认知的桥梁

* 对比分析
  * 预警分析
  * 进度分析
  * 差异分析
  * 纵向分析
  * 横向分析
  * 各种对比
* 结构分析
  * 构成分析
  * 杜邦分析
* 透视分析
  * 数据透视表
  * 数据透视图
  * 上卷、下钻分析
  * 不同汇总规则计算
* 其他分析方法
  * 变化分析
  * 分组分析
  * 增维分析

#### 交互式——从静态数据报表到动态商业智能报表的飞跃

交互式将获取数据信息的主动权交到报表阅读者手中



## Excel

### Excel必备技巧

* Excel基本功能
  * 熟练使用格式设定、制图、数据透视表等功能
* Power BI插件
  * 熟悉Power Query、Power Pivot等插件工具使用方法
* 高级图表制作技巧
  * 掌握动态图表、自定义图表制作技巧
* 公式功能
  * 掌握计算、查找定位等主要函数及嵌套函数使用方法
* VBA功能
  * 学会录制宏技巧、编辑简单的VBA程序

### Excel基本操作

**表格和数据的标准化和规范化**

管理表格：

* 首行列标题
* 数据格式统一

避免：

1. 空行
2. 合并单元格
3. 不必要的公式

条件格式

* 图标集

* 数据条、色阶

迷你图

​	位置：`插入  -> 迷你图`

​	折线图、柱形图、盈亏图

### Power BI

> * Power Map  地图工具，独立界面
> * Power View  仪表盘工具，独立界面
> * Power Query  数据处理，Excel界面
> * Power Pivot  透视工具，Excel界面

**Excel BI = Excel  + Power BI**

**流程**

1. Power Query导入外部数据
2. Power Query数据加工处理
3. Power Pivot搭建多维数据集
4. Power Map、Power View与Excel表格界面

#### Power Query概述

1. 提取整合多数据源数据（如各种关系型数据库、Excel文件、txt格式以及csv格式等文本文件、Web页面、Hadoop的HDFS等）
2. 突破Excel表格的数据限制（可快速处理几百万甚至上千万行的数据）
3. 提供丰富的数据处理分析功能
4. 可通过M函数灵活创建自定义数据处理及计算规则
5. 创建好的数据处理流程可以无限次使用

位置：`数据 -> 获取和转换`

![](D:\大学\笔记\python数据分析\业务数据分析\4.png)

**Power Query导入数据方式**

* 仅创建连接
* 表

如果导入数据出现乱码，可以在查询设置区域点击`源`，修改编码格式

**横向合并数据**  添加新的列

合并方法：

1. 确定用于合并两表的关键字段
2. 进行合并操作
3. 选择所需要的字段信息

位置：`PQ界面-开始-合并查询`

注：

1. 当两表中用于合并的关键字段值不是一一对应时，不同的联接种类会出现不同的联接结果
2. 当关键字段中有重复值时，连接后的总行数为关键字段值重复出现次数的乘积

**纵向合并流程**  添加新的行

1. 将有相同字段名的字段纵向合并到一起
2. 将不同字段名的字段追加到最后
3. 非匹配字段标记为“null”值

位置：`PQ界面-开始-追加查询`

![](D:\大学\笔记\python数据分析\业务数据分析\5.png)



**M函数**

编辑M函数的方法：

1. 通过”编辑栏“、”添加自定义列“或”高级编辑器“等功能了解M函数表达式写法
2. 根据需求重新编辑表达式程序
3. 编辑错误通过”查询设置“区域退回重新编辑
4. 在编辑器中使用”=#shared“可以查看M函数列表

* Table.AddIndexColumn(上一步操作, 新添加的索引列名称, 起始值, 步长)
  * 添加索引列
* Table.RecorderColumns(上一步操作, {排列后的列名})
  * 列 重排序
* Text.Range(列或字符串, index, length)
  * 在列或字符串的第index处获取长度为length的字符串
* Table.AddColumn(上一步操作结果, "性别", each Text.Range([身份证号码], 16, 1))
  * 获取在上一步操作结果中的身份证号码行的第17位，并添加为新列”性别“
* Table.TransformColumnTypes(上一步操作结果, {"要转换类型的列"， 数据类型})
  * 修改一个列的数据类型
  * 数据类型有Int64.Type
* Table.TransformColumnTypes(上一步操作结果, {"要转换类型的列"，Number.IsEven, type logical})
  * 判断要转换的列是否是偶数，结果为True/False
* Table.ReplaceValue(上一步操作, 旧值, 新值, Replacer.ReplaceText, {"要替换的列"})

**高级编辑器**



#### Power Pivot概述

Power Pivot是一款加强版的数据透视工具，不仅在数据处理量上，在透视规则以及自定义规则上也得到了大幅改善

1. 搭建多维数据分析环境
   * 在不同数据源之间建立关系
2. 突破数据行数限制
3. 简洁的操作界面功能
4. 强大的自定义功能
   * DAX表达式

位置：`数据 -> 管理数据模型` 或者 `加载项中加载Power Pivot，并添加至选项卡`

#### Power View概述

* 快速制作仪表盘
* 快速筛选查看

位置：`加载项中加载Power View，并添加至选项卡`

#### Power Map概述

结合Bing地图，支持用户绘制可视化的地理和时态数据，并用3D方式进行分析

需要在联网环境下使用Power Map

位置：`插入 -> 三维地图`

## Excel，Excel Power BI与MySQL在商业分析中的应用

1. MySQL数据导入整合
2. Power Query数据加工处理
3. Power Pivot搭建多维数据集
4. Power View与Excel表格界面

![](D:\大学\笔记\python数据分析\业务数据分析\1.png)

![](D:\大学\笔记\python数据分析\业务数据分析\2.png)

![](D:\大学\笔记\python数据分析\业务数据分析\3.png)



## SQL

### 导入外部csv文件

```sql
load data local infile '[csv文件的绝对路径]'
	into table [表名]
	fields terminated by '[分隔符，csv文件的分隔符是,]'
	ignore [忽略的行数] lines
```

### 查询到的数据来创建表

创建名为allinfo的完整字段信息表（allinfo表中包括orderinfo表的所有字段与regioninfo表中的国家与地区字段）

```sql
create allinfo(
select orderinfo.*, regioninfo.国家, regioninfo.地区
from orderinfo, regioninfo
where orderinfo.城市编号 = regioninfo.城市编号)
```

