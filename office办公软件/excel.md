### 1 数据类型

* 数值

  * 自动右对齐
  * 数值型数字：在Excel中可以参与计算，例如求和、平均值、最大值、最小值
  * 文本型数字：在Excel不可以参与计算，只能计数
  * 注意：Excel中，文本型数字与数值型数字计算之后得到的是数字型数字
  * 文本型数字 -> 数字型数字
    * 复制一个空的单元格，选择性粘贴到要转换的区域，选择加运算，空单元格会被当作为0）
    * 本质：文本型数字进行四则运算
  * 数字型数字 -> 文本型数字
    * 先转换格式，再使用`数据 -> 分列`

* 日期

  * 自动右对齐 （但是对于一些非正常的日期，比如平年的2月29，会识别为文本型）

  * 本质就是一个序列值

  * 在Windows系统中，以1900/1/1的序列值为1，1900/1/2的序列值为2，以此类推

  * 在Mac系统中，以1904/1/1的序列值为1

  * 序列值的基准可以在`文件 -> 选项 -> 高级 -> 选用1904日期系统`

  * 时间

    * 时间的输入使用冒号分隔

    ```
    由于日期一天对应的序列值是1，一天有24小时，1440分钟，86400秒钟
    那么一个小时的序列值就是1/24
    一分钟的序列值就是1/1440
    一秒钟的序列值就是1/86400
    ```

* 文本

  * 自动左对齐

* 公式（包含函数）

* 其他特殊类型（逻辑值，错误值）

  * 逻辑值转换为数值
    * True -> 1, False -> 0
  * 数值转换为逻辑值
    * 0 -> False, 非0 -> 1
  * 注意：文本与数值进行比较时，文本大于任何数值

注意：当单元格的格式变成`;;;`时，单元格显示的内容为空（此时，隐藏该单元格并进行保护工作表，会隐藏数据）

### 2 自定义序列

`文件 -> 选项 -> 高级 -> 编辑自定义列表 `

排序可以按照自定义的序列进行排序

### 3 冻结窗格

可以选择冻结首行或者冻结首列

也可以选择冻结窗格，使得当前活动单元格的上一行和列被冻结

### 4 自定义视图

`视图 -> 自定义视图`

可以添加或显示视图

### 5 自定义数字格式

`正数格式;负数格式;零值格式;文本格式` 4个区段

| 区段数 | 代码含义                                                     |
| ------ | ------------------------------------------------------------ |
| 1      | 格式代码作用到所有类型的数值                                 |
| 2      | 第1区间应用在正数和零值，第2区间应用在负数（文本正常显示）   |
| 3      | 第1区间应用在正数，第2区间应用在负数，第3区间应用在零值（文本正常显示） |
| 4      | 第1区间应用在正数，第2区间应用在负数，第三区间应用在零值，第4区间应用在文本 |

**常见用于创建自定义数字格式代码**

| 代码       | 含义                                                         |
| ---------- | ------------------------------------------------------------ |
| G/通用格式 | 不设置任何格式，同“常规”格式                                 |
| #          | 数字占位符，只显示有效数字，不显示无意义的零值               |
| ？         | 数字占位符，用空格显示无意义的零值，常用于显示分数           |
| 0          | 数字占位符，如果数字中的位数少于代码格式中的位数时，显示无意义的零值 |
| .          | 小数点                                                       |
| ，         | 千位分隔符                                                   |
| “文本”     | 在数字后面显示双引号之间的文本                               |
| %          | 百分数显示                                                   |

显示为真实数值的千分之一：`0,`

显示为真实数值的千分之一，并带有两位小数：`0,.00`

**日期时间代码**

| 代码          | 解释                                             |
| ------------- | ------------------------------------------------ |
| aaa           | 中文简称显示星期几（“一”到“日”）                 |
| aaaa          | 中文全称显示星期几（“星期一”到“星期日”）         |
| d             | 没有前导零的数字显示日期（1-31）                 |
| dd            | 有前导零的数字显示日期（01-31）                  |
| m             | 没有前导零的数字显示月份或分钟（1-12）或（0-59） |
| mm            | 有前导零的数字显示月份或分钟（01-12）或（00-59） |
| yy            | 使用两位数字显示公历年份（00-99）                |
| yyyy          | 使用四位数字显示公历年份（1900-9999）            |
| h             | 使用没有前导零的数字来显示小时（0-23）           |
| hh            | 使用有前导零的数字来显示小时（00-23）            |
| s             | 使用没有前导零的数字来显示秒钟（0-59）           |
| ss            | 使用有前导零的数字来显示秒钟（00-59）            |
| [h]、[m]、[s] | 显示超出进制的小时数、分数、秒数                 |
| AM/PM         | 使用英文上下午显示12进制时间                     |
| A/P           | 同上                                             |
| 上午/下午     | 使用中文上下午显示12进制时间                     |

### 6 单元格的复制和单元格内容的复制

单元格的复制：其公式或函数的相对引用会发生变化

单元格中内容的复制：公式或函数不会发生变化

### 7 单元格的引用

#### 7.1 相对引用

Excel中复制公式的默认引用方式，例如:`A1`

快速把相对引用变成绝对引用：`F4`键

#### 7.2 绝对引用

例如:`$A$1`

#### 7.3 混合引用

行绝对，列相对：`A$1`

列相对，行绝对：`$A1`

#### 7.4 跨工作表的引用

`工作表名!单元格引用`

比如：销售表!E1

如果工作表以数字或特殊字符开头，需要使用单引号进行包裹

#### 7.5 循环引用

单元格的公式或者计算再次使用到当前的单元格的内容，会导致循环引用

`公式 -> 错误检查 -> 循环引用`  显示当前循环引用的内容

### 8 显示公式

1. `公式 -> 显示公式`
2. `FORMULATETEXT(单元格引用)`

### 9 Excel公式错误类型

| 错误值类型 | 含义                                               |
| ---------- | -------------------------------------------------- |
| #####      | 当列宽不够显示数字，或者使用了负的日期时间         |
| #VALUE!    | 使用的参数类型不正确                               |
| #DIV/0!    | 数字被零（0）除                                    |
| #NAME?     | 公式中使用了未定义的范围或者单元格的名称           |
| #N/A       | 查找函数找不到匹配的值                             |
| #REF!      | 公式中使用了无效的单元格引用                       |
| #NUM!      | 公式中使用了无效数字或者无效参数                   |
| #NULL!     | 计算两个实际并不相交范围的交叉单元格时会出现此错误 |

### 10 定义名称

**第一种方式**

选择数据区域，在活动单元格中输入要定义的名称内容（此时，该名称代表选中的数据区域）

**第二种方式**

选择数据区域，在`公式 -> 根据所选内容创建`定义多个名称

### 11 通配符

`？`  一个字符

`*`    0至多个字符



## 快捷键

* `tab`键将活动单元格移到右边，`Enter`键将活动单元格移到下边，`Ctrl + Enter`结束当前公式的编辑，并且将活动单元格停留在原地
* `Ctrl + ;`   快速输入当前日期
* `Ctrl + Shift + ;`   快速输入当前时间
* `Ctrl + down方向键`快速跳转到当前列的连续数据的最后一行
* `Ctrl + Shift + down方向键`  快速选择某一列的所有连续的数据
* `Ctrl + D` 向下填充，`Ctrl + R`向右填充
* `Ctrl + G`进行快速定位
* `Alt + down方向键`弹出可选择的已输入数据列表
* 在单元格中输入的时候，使用`Alt + Enter`强制换行
* `Ctrl + PageUp`切换到上一张工作表，`Ctrl + PageDown`切换到下一张工作表
* `Ctrl + 8`显示或隐藏分组符号  （组合：`数据 -> 组合`）
* 拖动单元格或数据区域时
  * 按住`Ctrl`键，会替换掉移动后的区域，原来的区域变成空白
  * 按住`Shift`键，会插入到移动后的区域，原来的区域变成空白
  * 按住`Ctrl + Shift`键，会插入到移动后的区域，原来的区域数据不变
* `Alt + +`进行快速求和
* `Ctrl + Shift + Enter`用数组公式的方式结束对公式的编辑
* `Alt + F1`快速插入一张嵌入工作表的图表
* `F11`快速插入一张独占工作表的图表

## 函数

* sum(number[, number])
  * 对数值型数字进行求和
  * 会自动忽略文本型数字，逻辑值，文本
* sumif(range, criteria, [sum_range])
  * 根据条件对数据区域进行求和
  * range:条件区域
  * criteria:条件
  * sum_range:求和区域
  * 如果sum_range省略，默认求和区域是range
* sumifs(sum_range, criteria_range1, criteria1, [criteria_range2, criteria2])
  * 按多个条件对指定单元格求和
* sumproduct(array1, array2, array3, ...)
  * 计算数组的对应索引元素的乘积之和
* countif(range, criteria)
  * 统计符合条件的单元格数量
* countifs(range, criteria, [range_2, criteria], [...])
  * 统计符合多个条件的区域的数量
* count
  * 统计参数中包含数字的个数
* counta
  * 统计参数中包含非空值的个数
* countblank
  * 统计区域内空白单元格的个数
* average
  * 计算参数的平均值
* averageif(range, criteria, [average_range])
  * 单条件计算平均值
* averageifs(average_range, range_1, criteria_1, range_2, criteria_2, ...)
  * 多条件计算平均值
* product
  * 将所有单元格参数的内容进行乘积操作
* frequency(data_array, bins_array)
  * 统计数据在不同分段中的频率
  * data_array：数据区域
  * bins_array:分段区域
  * 先选中比分段数多一个的单元格数，以数组形式输入公式
* max(number, ...)
  * 返回一组值中的最大数
* min(number, ...)
  * 返回一组值中的最小数
* large(array, k)
  * 返回数据中第k个最大值
* small(array, k)
  * 返回数据中第k个最小值
* round(number, num_digits)
  * 按指定位数对数字进行四舍五入
  * num_digits可以为负数，如-2表示四舍五入到百位数
* roundup(number, num_digits)
  * 向上舍入（进一法）
* rounddown(number, num_digits)
  * 向下舍入（去尾法）
* int(number)
  * 将number向下舍入到最接近的整数
* trunc(number, [num_digit])
  * 对number进行截断取整
  * num_digit：截断的位数，默认为0，即删除小数部分。如果是负数，如-2表示截断到百位数
* rand()
  * 返回0到1之间的一个随机数
* randbetween(bottom, top)
  * 返回位于指定的两个数之间的一个随机数
* mod(number, divisor)
  * 返回两数相除的余数，结果的正负号与除数相同
* quotient(numerator, denominator)
  * 返回商的整数部分

### 日期函数

* today()
  * 返回当前系统的日期
* now()
  * 返回当前系统的日期加时间
* year(serial_num)
  * 返回年份
* month(serial_num)
  * 返回月份
* day(serial_num)
  * 返回日期中的某一天
* hour(serial_num)
  * 返回小时数
* minute(serial_num)
  * 返回分钟数
* second(serial_num)
  * 返回秒钟数

* date(year, month, day)
  * 返回表示特定日期的连续序列号
* time(hour, minute, second)
  * 返回指定时间的序列号
* weekday(serial_num, [return_type])
  * 返回某日期为星期几
  * return_type：返回数值与日期之间的关系
    * 1：星期天为1，以此类推，1是默认值
    * 2：星期一为1
* weeknum(serial_num, [return_type])
  * 计算某日期位于当年的第几周
* networkdays(start_date, end_date, [holidays])
  * 计算日期之间的所有工作日
  * holidays：要剔除的日期（可为单元格引用）
* workday(start_date, days, [holidays])
  * 计算指定日期向前或向后数个工作日后的日期
* eomonth(start_date, months)
  * 指定日期向前或向后几个月的那个月的最后一天日期
* edate(start_date, months)
  * 指定日期向前或向后几个月的日期
* datedif(start_date, end_date, unit)
  * 计算开始与结束日期之间的日期间隔
  * unit
    * "y":相差的年份
    * "m":相差的月份
    * "d":相差的天数
    * "ym":忽略年统计相差的月份
    * "yd":忽略年统计相差的天数
    * "md":忽略年月统计相差的天数

### 查找函数

* row([reference])
  * 返回数组形式引用的行号，如果没有参数，返回当前单元格的行号
* rows(array)
  * 返回引用或数组的行数
* column([reference])
  * 返回指定单元格引用的行号
* columns([array])
  * 返回数组或者是引用的行数
* indirect([reference_text])
  * 返回由文本字符串指定的引用
  * indirect(C1)   返回C1单元格的文本对应的单元格的内容
  * indirect("C1")  返回C1单元格的内容
  * 跨工作表引用中经常用到
* choose(index_num, value_1, [value_2, value_3, ...])
  * 根据序号从列表中选择对应的内容
  * index_num为1，返回value_1；为2，返回value_2；……
* vlookup(lookup_value, table_array, col_index_num, [range_lookup])
  * 在table_array的第一列查找lookup_value，返回与指定值同行的该区域或数组中第col_index_num的值
  * range_lookup
    * TRUE   模糊查询
    * FALSE  精确查询
  * 如果使用模糊查询，则table_array的第一列必须是**升序排列**，否则会出现意料之外的错误
  * 注意：查询的数据类型必须匹配
* hlookup(lookup_value, table_array, row_index_num, [range_lookup])
  * 在table_array的第一行查找lookup_value，返回与指定值同列的该区域或数组中第col_index_num的值
* lookup(lookup_value, lookup_vector, result_vector)
  * 仅在单行单列中查找数据
  * lookup不能设置查询类型，所以数据一定要按照升序排列
* lookup(lookup_value, array)
  * 在区域或数组的首列或首行中查找数据，返回对应的最后一列数据
* match(lookup_value, lookup_array, [match_type])
  * 在单元格区域内搜索指定项，返回该项在单元格中的相对位置
  * match_type
    * 非0是模糊查询，要求行或列是升序排列
    * 1，查找不到返回小于的数
    * -1，查找不到返回大于的数
    * 0是精确查询，查询不到返回`#N/A`

* index(array, row_num, [col_num])
  * 返回单元格区域或数组中行与列交叉位置上的值
  * array：所在区域
  * row_num：返回元素的行号
  * col_num：返回元素的列号
* index(array, row_num, col_num, area_num)
  * array：多个查询区域
  * row_num：返回元素的行号
  * col_num：返回元素的列号
  * area_num：查询区域的编号（1，2，...）
* offset(reference, rows, cols, [height], [width])
  * 根据给定的偏移量返回新的引用区域
  * reference：偏移的基准位置
  * rows,cols：向下偏移的行数与向右偏移的列数
  * height：返回引用区域的列数
  * width：返回引用区域的行数

### 逻辑函数

* and(logic1, [logic2, ...])
* or(logic1, [logic2, ...])
* not(logic)
* and可以用乘号代替，or可以用加号代替
* if(logic, [value_if_true], [value_if_false])
  * 执行真假值判断，根据逻辑测试返回不同的结果
* iferror(value, value_if_error)
  * 计算value，如果没有错误直接返回计算结果，如果有错误返回value_if_error
* ifna(value, value_if_error)
  * 计算value并返回，如果有NA错误返回value_if_error
* isblank
  * 判断单元格是否为空单元格
* islogical
  * 判断值是否是逻辑值
* isnumber
  * 判断值是否是数字
* istext
  * 判断值是否是文本
* isnontext
  * 判断值是否是非文本
* iseven
  * 判断数字是否是偶数
* isodd
  * 判断数字是否是奇数

* isref
  * 判断值是否是单元格引用
* isformula
  * 判断值是否是公式
* isna
  * 判断值是否是错误#N/A
* iserr
  * 判断值是否是除#N/A之外其他的错误值
* iserror
  * 判断值是否是错误值

### 文本型函数

函数的返回值是文本

* concatenate(text, [text2, ...])
  * 将多个文本合并在一起
* char(number)
  * 返回编码对应的字符
* code(text)
  * 返回字符所对应的编码

* Exact(text1, text2)
  * 比较两文本是否相同，区分大小写（由于在Excel中直接使用=是不区分大小写进行比较的）
* len(text)
  * 返回文本字符串中的字符数
* lenb(text)
  * 返回文本字符串中用于代表字符的字节数
* upper(text)
  * 将文本转换为大写
* lower(text)
  * 将文本转换为小写
* proper(text)
  * 将文本中的每个单词的首字母转换为大写，其余转换为小写
* left(text, [num_chars])
  * 从文本左侧提取num_chars的字符
* right(text, [num_chars])
  * 从文本右侧提取num_chars的字符
* mid(text, start, [num_chars])
  * 从text中的start处开始提取num_chars个字符
* find(find_text, within_text, [start_num])
  * 以字符为单元并且区分大小写查找指定字符位置
  * start_num省略则从第一个字符开始查找
  * 找不到会返回#VALUE!
* search(find_text, within_text, [start_num])
  * 以字符为单元但**不**区分大小写查找指定字符位置
  * 找不到会返回#VALUE!
* replace(old_text, start_num, num_chars, new_text)
  * 根据指定位置进行替换
* substitute(text, old_text, new_text, [instance_num])
  * 根据指定文本进行替换
  * instance_num：表示第几次替换旧文本，如果省略，则替换所有文本
* text(value, format_text)
  * 将数字转换为按指定格式显示的文本
  * 如：text(A2, "yyyy-mm-dd")

## 图表

**柱形图**

簇状柱形图表示不同时期的数据变化情况或者不同类别之间的数据差异

堆积柱形图主要比较每个分类项的总和

百分比堆积柱形图

**条形图**

本质是柱形图旋转顺时针90度

**饼图**

只会作用于一个数据系列

数据系列的数据最好不要超过5项

如果数据系列的数据过多，可以使用**复合饼图**

饼图的数据标签最好是百分比，图例和数值尽量不要分开放

**折线图**

主要描述时间、温度、速度这些具有连续关系的数据，了解这些数据的趋势、动态走势、规律等等

**散点图**

查看全体数据点所共同呈现出的接近性

**气泡图**

建议使用在少量并且是数据离散的情况下

使用二维来展示三维数据（第三个维度用面积表示）